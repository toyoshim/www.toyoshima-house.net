<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta name="Microsoft Theme 2.00" content="capsules 111">
<meta http-equiv=Content-Type content="text/html; charset=shift_jis">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./hotmail.files/filelist.xml">
<title>Hotmail解析結果</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>豊島　隆志</o:Author>
  <o:LastAuthor>豊島　隆志</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>278</o:TotalTime>
  <o:Created>1999-10-30T19:48:00Z</o:Created>
  <o:LastSaved>1999-10-30T19:48:00Z</o:LastSaved>
  <o:Pages>8</o:Pages>
  <o:Words>1031</o:Words>
  <o:Characters>5880</o:Characters>
  <o:Company>acenet</o:Company>
  <o:Lines>49</o:Lines>
  <o:Paragraphs>11</o:Paragraphs>
  <o:CharactersWithSpaces>7221</o:CharactersWithSpaces>
  <o:Version>9.2812</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:PunctuationKerning/>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
  <w:Compatibility>
   <w:SpaceForUL/>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:AdjustLineHeightInTable/>
   <w:UseFELayout/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"ＭＳ 明朝";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-alt:"MS Mincho";
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:"ＭＳ ゴシック";
	panose-1:2 11 6 9 7 2 5 8 2 4;
	mso-font-alt:"MS Gothic";
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:"ＭＳ Ｐゴシック";
	panose-1:2 11 6 0 7 2 5 8 2 4;
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:variable;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:"\@ＭＳ Ｐゴシック";
	panose-1:2 11 6 0 7 2 5 8 2 4;
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:variable;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:"\@ＭＳ ゴシック";
	panose-1:2 11 6 9 7 2 5 8 2 4;
	mso-font-charset:128;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
@font-face
	{font-family:"\@ＭＳ 明朝";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-pitch:fixed;
	mso-font-signature:-1610612033 1757936891 16 0 131231 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0mm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	font-family:"ＭＳ Ｐゴシック";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	mso-font-kerning:1.0pt;}
h1
	{mso-style-next:標準;
	margin:0mm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:24.0pt;
	font-family:"ＭＳ Ｐゴシック";
	color:#000099;
	mso-font-kerning:1.0pt;
	font-weight:normal;}
h2
	{mso-style-next:標準;
	margin:0mm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:18.0pt;
	font-family:"ＭＳ Ｐゴシック";
	color:#336666;
	mso-font-kerning:1.0pt;
	font-weight:normal;}
h3
	{mso-style-next:標準;
	margin-top:0mm;
	margin-right:0mm;
	margin-bottom:0mm;
	margin-left:4.0gd;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:14.0pt;
	font-family:"ＭＳ Ｐゴシック";
	color:#000099;
	mso-font-kerning:1.0pt;
	font-weight:normal;}
h4
	{mso-style-next:標準;
	margin-top:0mm;
	margin-right:0mm;
	margin-bottom:0mm;
	margin-left:4.0gd;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:12.0pt;
	font-family:"ＭＳ Ｐゴシック";
	color:#336666;
	mso-font-kerning:1.0pt;
	font-weight:normal;
	mso-bidi-font-weight:bold;}
h5
	{mso-style-next:標準;
	margin-top:0mm;
	margin-right:0mm;
	margin-bottom:0mm;
	margin-left:8.0gd;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:10.0pt;
	font-family:"ＭＳ Ｐゴシック";
	color:#000099;
	mso-font-kerning:1.0pt;
	font-weight:normal;}
h6
	{mso-style-next:標準;
	margin-top:0mm;
	margin-right:0mm;
	margin-bottom:0mm;
	margin-left:8.0gd;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:6;
	font-size:8.0pt;
	font-family:"ＭＳ Ｐゴシック";
	color:#336666;
	mso-font-kerning:1.0pt;
	font-weight:normal;
	mso-bidi-font-weight:bold;}
a:link, span.MsoHyperlink
	{color:#339966;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:#0033CC;
	text-decoration:underline;
	text-underline:single;}
p.a, li.a, div.a
	{mso-style-name:引用;
	margin:0mm;
	margin-bottom:.0001pt;
	line-height:12.0pt;
	mso-line-height-rule:exactly;
	mso-pagination:none;
	tab-stops:21.0pt 42.0pt 63.0pt 84.0pt 105.0pt 126.0pt;
	layout-grid-mode:char;
	mso-layout-grid-align:none;
	font-size:9.0pt;
	mso-bidi-font-size:10.5pt;
	font-family:"ＭＳ ゴシック";
	mso-hansi-font-family:"ＭＳ Ｐゴシック";
	mso-bidi-font-family:"Times New Roman";
	color:#333333;}
 /* Page Definitions */
@page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:99.25pt 30.0mm 30.0mm 30.0mm;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-paper-source:0;
	layout-grid:18.0pt;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:1329093563;
	mso-list-type:hybrid;
	mso-list-template-ids:-1343600200 -394875132 67698699 67698701 67698689 67698699 67698701 67698689 67698699 67698701;}
@list l0:level1
	{mso-level-start-at:0;
	mso-level-number-format:bullet;
	mso-level-text:・;
	mso-level-tab-stop:18.0pt;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;
	font-family:"ＭＳ 明朝";
	mso-bidi-font-family:"Times New Roman";}
ol
	{margin-bottom:0mm;}
ul
	{margin-bottom:0mm;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor=white background="./hotmail.files/image001.gif" lang=JA
link="#339966" vlink="#0033cc" style='tab-interval:42.0pt;text-justify-trim:
punctuation'>
<!--[if gte mso 9]><xml>
 <v:background id="_x0000_s1025" o:bwmode="white" o:targetscreensize="800,600">
  <v:fill src="./hotmail.files/image001.gif" o:title="captext" type="frame"/>
 </v:background></xml><![endif]-->

<div class=Section1 style='layout-grid:18.0pt'>

<h1 align=center style='text-align:center'><span lang=EN-US>Hotmail解析結果</span></h1>

<div style='border-top:solid windowtext .75pt;border-left:none;border-bottom:
solid windowtext .75pt;border-right:none;padding:1.0pt 0mm 1.0pt 0mm'>

<p class=MsoNormal align=right style='text-align:right;border:none;mso-border-top-alt:
solid windowtext .75pt;mso-border-bottom-alt:solid windowtext .75pt;padding:
0mm;mso-padding-alt:1.0pt 0mm 1.0pt 0mm'><span lang=EN-US>1999年10月30日 とよしま</span></p>

</div>

<h2>概容</h2>

<p class=MsoNormal><span lang=EN-US>hotmailをweb以外から利用する場合、特殊な方法を用いる事で効率的にメールデータにアクセスできる。本稿はhotmailをPOP3対応の通常のメーラーから読むために開発予定のPOP3
to Web-Mail Gateway開発のために書かれた。また、この資料を作成するにあたり、Outlook Expressの通信内容を参考にした。</span></p>

<span lang=EN-US style='font-size:18.0pt;font-family:"ＭＳ Ｐゴシック";mso-bidi-font-family:
"Times New Roman";color:#336666;mso-font-kerning:1.0pt;mso-ansi-language:EN-US;
mso-fareast-language:JA;mso-bidi-language:AR-SA'><br clear=all
style='page-break-before:always'>
</span>

<h2>プロトコル</h2>

<p class=MsoNormal><span lang=EN-US>hotmailで使用されるプロトコルは、HTTP/1.1をベースに、若干独自拡張を施したものである。また、認証にはDigest認証を用いるので、これに対応していなければならない。独自拡張は主に、リクエストコマンドの追加と、レスポンスステータスの追加である。これらについては次に説明を示す。Digest認証についてはrfc-2617を参考の事。また、本来Digest認証はHTTP/1.1の元に実装されるべきであるが、HTTP/1.0上に実装してもhotmailを利用するにあたって問題は確認されていない。また、User-AgentはOutlook
Expressを名乗る必要がある、ということに注意しなければならない。</span></p>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3 style='margin-left:42.0pt'>追加されたリクエストコマンド</h3>

<div align=center>

<table border=1 cellspacing=0 cellpadding=0 width=547 style='width:409.95pt;
 border-collapse:collapse;border:none;mso-border-top-alt:1.0pt;mso-border-left-alt:
 1.0pt;mso-border-bottom-alt:1.5pt;mso-border-right-alt:1.5pt;mso-border-color-alt:
 #99CC99;mso-border-style-alt:solid;mso-padding-alt:0mm 4.95pt 0mm 4.95pt'>
 <tr style='height:3.5pt'>
  <td width=105 valign=top style='width:78.9pt;border-top:1.0pt;border-left:
  1.0pt;border-bottom:.75pt;border-right:.75pt;border-color:#99CC99;border-style:
  solid;background:#B4B4CA;mso-shading:white;mso-pattern:gray-50 navy;
  padding:0mm 4.95pt 0mm 4.95pt;height:3.5pt'>
  <p class=MsoNormal align=center style='text-align:center'><b><i><span
  style='color:white'>コマンド<span lang=EN-US><o:p></o:p></span></span></i></b></p>
  </td>
  <td width=441 valign=top style='width:331.05pt;border-top:solid #99CC99 1.0pt;
  border-left:none;border-bottom:solid #99CC99 .75pt;border-right:solid #99CC99 1.5pt;
  mso-border-left-alt:solid #99CC99 .75pt;background:#B4B4CA;mso-shading:white;
  mso-pattern:gray-50 navy;padding:0mm 4.95pt 0mm 4.95pt;height:3.5pt'>
  <p class=MsoNormal align=center style='text-align:center'><b><i><span
  style='color:white'>解説<span lang=EN-US><o:p></o:p></span></span></i></b></p>
  </td>
 </tr>
 <tr style='height:3.9pt'>
  <td width=105 valign=top style='width:78.9pt;border-top:none;border-left:
  solid #99CC99 1.0pt;border-bottom:solid #99CC99 .75pt;border-right:solid #99CC99 .75pt;
  mso-border-top-alt:solid #99CC99 .75pt;padding:0mm 4.95pt 0mm 4.95pt;
  height:3.9pt'>
  <p class=MsoNormal><b><span lang=EN-US style='color:windowtext'>PROPFIND<o:p></o:p></span></b></p>
  </td>
  <td width=441 valign=top style='width:331.05pt;border-top:none;border-left:
  none;border-bottom:solid #99CC99 .75pt;border-right:solid #99CC99 1.5pt;
  mso-border-top-alt:solid #99CC99 .75pt;mso-border-left-alt:solid #99CC99 .75pt;
  padding:0mm 4.95pt 0mm 4.95pt;height:3.9pt'>
  <p class=MsoNormal><span lang=EN-US style='color:windowtext'>Login中のユーザーに属する、各種データにアクセスするためのURLと付随情報を調査する。どのデータに関して調査するかはcontentとして送信されるXMLに記述される。このコマンドは複数の要求を同時に発行することができるようになっている。<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='height:3.9pt'>
  <td width=105 valign=top style='width:78.9pt;border-top:none;border-left:
  solid #99CC99 1.0pt;border-bottom:solid #99CC99 .75pt;border-right:solid #99CC99 .75pt;
  mso-border-top-alt:solid #99CC99 .75pt;padding:0mm 4.95pt 0mm 4.95pt;
  height:3.9pt'>
  <p class=MsoNormal><b><span lang=EN-US style='color:windowtext'>PROPPATCH<o:p></o:p></span></b></p>
  </td>
  <td width=441 valign=top style='width:331.05pt;border-top:none;border-left:
  none;border-bottom:solid #99CC99 .75pt;border-right:solid #99CC99 1.5pt;
  mso-border-top-alt:solid #99CC99 .75pt;mso-border-left-alt:solid #99CC99 .75pt;
  padding:0mm 4.95pt 0mm 4.95pt;height:3.9pt'>
  <p class=MsoNormal><span lang=EN-US style='color:windowtext'>Login中のユーザーに属する各データ固有の情報を変更する。主にメールの未読フラグの変更等に利用される。<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='height:3.5pt'>
  <td width=105 valign=top style='width:78.9pt;border-top:none;border-left:
  solid #99CC99 1.0pt;border-bottom:solid #99CC99 1.5pt;border-right:solid #99CC99 .75pt;
  mso-border-top-alt:solid #99CC99 .75pt;padding:0mm 4.95pt 0mm 4.95pt;
  height:3.5pt'>
  <p class=MsoNormal><b><span lang=EN-US style='color:windowtext'>MOVE<o:p></o:p></span></b></p>
  </td>
  <td width=441 valign=top style='width:331.05pt;border-top:none;border-left:
  none;border-bottom:solid #99CC99 1.5pt;border-right:solid #99CC99 1.5pt;
  mso-border-top-alt:solid #99CC99 .75pt;mso-border-left-alt:solid #99CC99 .75pt;
  padding:0mm 4.95pt 0mm 4.95pt;height:3.5pt'>
  <p class=MsoNormal><span style='color:windowtext'>階層化されている各データを別階層に移動する。主にメールをごみ箱へ移動させる等に利用される。<span
  lang=EN-US><o:p></o:p></span></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3 style='margin-left:42.0pt'>追加されたレスポンスステータス</h3>

<div align=center>

<table border=1 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 border:none;mso-border-top-alt:1.0pt;mso-border-left-alt:1.0pt;mso-border-bottom-alt:
 1.5pt;mso-border-right-alt:1.5pt;mso-border-color-alt:#99CC99;mso-border-style-alt:
 solid;mso-padding-alt:0mm 4.95pt 0mm 4.95pt'>
 <tr>
  <td width=140 valign=top style='width:105.15pt;border-top:1.0pt;border-left:
  1.0pt;border-bottom:.75pt;border-right:.75pt;border-color:#99CC99;border-style:
  solid;background:#B4B4CA;mso-shading:white;mso-pattern:gray-50 navy;
  padding:0mm 4.95pt 0mm 4.95pt'>
  <p class=MsoNormal><b><i><span style='color:white'>コード<span lang=EN-US><o:p></o:p></span></span></i></b></p>
  </td>
  <td width=408 valign=top style='width:305.75pt;border-top:solid #99CC99 1.0pt;
  border-left:none;border-bottom:solid #99CC99 .75pt;border-right:solid #99CC99 1.5pt;
  mso-border-left-alt:solid #99CC99 .75pt;background:#B4B4CA;mso-shading:white;
  mso-pattern:gray-50 navy;padding:0mm 4.95pt 0mm 4.95pt'>
  <p class=MsoNormal><b><i><span style='color:white'>解説<span lang=EN-US><o:p></o:p></span></span></i></b></p>
  </td>
 </tr>
 <tr>
  <td width=140 valign=top style='width:105.15pt;border-top:none;border-left:
  solid #99CC99 1.0pt;border-bottom:solid #99CC99 1.5pt;border-right:solid #99CC99 .75pt;
  mso-border-top-alt:solid #99CC99 .75pt;padding:0mm 4.95pt 0mm 4.95pt'>
  <p class=MsoNormal><b><span lang=EN-US>207 Multi-Status<o:p></o:p></span></b></p>
  </td>
  <td width=408 valign=top style='width:305.75pt;border-top:none;border-left:
  none;border-bottom:solid #99CC99 1.5pt;border-right:solid #99CC99 1.5pt;
  mso-border-top-alt:solid #99CC99 .75pt;mso-border-left-alt:solid #99CC99 .75pt;
  padding:0mm 4.95pt 0mm 4.95pt'>
  <p class=MsoNormal><span lang=EN-US>PROPFINDに対する応答として返す。要求ごとのレスポンスとステータスを要求だけ列挙したものをXMLとして返答してくる。</span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<span lang=EN-US style='font-size:18.0pt;font-family:"ＭＳ Ｐゴシック";mso-bidi-font-family:
"Times New Roman";color:#336666;mso-font-kerning:1.0pt;mso-ansi-language:EN-US;
mso-fareast-language:JA;mso-bidi-language:AR-SA'><br clear=all
style='page-break-before:always'>
</span>

<h2>サーバーへのアクセス</h2>

<p class=MsoNormal><span lang=EN-US>hotmailへの入り口となるURLは<a
href="http://services.msn.com/svcs/hotmail/httpmail.asp">http://services.msn.com/svcs/hotmail/httpmail.asp</a>
となっている。ただし、通常このアドレスは301/302等を返してくるので、Locationに従って再度別サーバーにアクセスすることになるはずである。移動後のアドレスは常に変更される可能性があるため、アクセス時には必ずこのアドレスから調べるべきである。</span></p>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3 style='margin-left:42.0pt'>ログイン</h3>

<p class=MsoNormal>ログインを開始するためには上で示した<span lang=EN-US>URLへPROPFINDを送信する必要がある。正しいアドレスにアクセスすると、401を返してくる。この際要求される認証がDigest認証となっている。クライアントはユーザー名、パスワードに従いDigestを計算し、それらを含め、再度サーバーにPROPFINDとして送る。このレスポンスとして207が返って来たならログインは成功である。PROPFINDとして送るデータは取得したい情報をXMLで列挙したものである。次に代表的な送信内容の例を示す。</span></p>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<div align=center>

<table border=1 cellspacing=0 cellpadding=0 width=598 style='width:448.7pt;
 border-collapse:collapse;border:none;mso-border-top-alt:solid #99CC99 1.5pt;
 mso-border-bottom-alt:solid #99CC99 1.5pt;mso-padding-alt:0mm 4.95pt 0mm 4.95pt'>
 <tr style='height:193.5pt'>
  <td width=598 valign=top style='width:448.7pt;border-top:solid #99CC99 1.5pt;
  border-left:none;border-bottom:solid #99CC99 .75pt;border-right:none;
  padding:0mm 4.95pt 0mm 4.95pt;height:193.5pt'>
  <p class=a><span lang=EN-US>&lt;?xml version=&quot;1.0&quot;?&gt;</span></p>
  <p class=a><span lang=EN-US>&lt;D:propfind xmlns:D=&quot;DAV:&quot;
  xmlns:h=&quot;http://schemas.microsoft.com/hotmail/&quot;
  xmlns:hm=&quot;urn:schemas:httpmail:&quot;&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;D:prop&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;h:adbar/&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;hm:contacts/&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;hm:inbox/&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;hm:outbox/&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;hm:sendmsg/&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;hm:sentitems/&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;hm:deleteditems/&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;hm:drafts/&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;hm:msgfolderroot/&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;h:sig/&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;/D:prop&gt;</span></p>
  <p class=a><span lang=EN-US>&lt;/D:propfind&gt;</span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US>D:propの内側にあるのが要求する情報の列挙となっている。レスポンスは以下の通り。</span></p>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<div align=center>

<table border=1 cellspacing=0 cellpadding=0 width=599 style='width:448.9pt;
 border-collapse:collapse;border:none;mso-border-top-alt:solid #99CC99 1.5pt;
 mso-border-bottom-alt:solid #99CC99 1.5pt;mso-padding-alt:0mm 4.95pt 0mm 4.95pt'>
 <tr>
  <td width=599 valign=top style='width:448.9pt;border-top:solid #99CC99 1.5pt;
  border-left:none;border-bottom:solid #99CC99 .75pt;border-right:none;
  padding:0mm 4.95pt 0mm 4.95pt'>
  <p class=a><span lang=EN-US>&lt;?xml version=&quot;1.0&quot;
  encoding=&quot;windows-1252&quot;?&gt;</span></p>
  <p class=a><span lang=EN-US>&lt;D:multistatus xmlns:D=&quot;DAV:&quot;
  xmlns:m=&quot;urn:schemas:mailheader:&quot;
  xmlns:hm=&quot;urn:schemas:httpmail:&quot;
  xmlns:c=&quot;urn:schemas:contacts:&quot;
  xmlns:h=&quot;http://schemas.microsoft.com/hotmail/&quot;&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;D:response&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;D:href&gt;http://</span><span
  lang=EN-US style='font-family:"ＭＳ Ｐゴシック";mso-ascii-font-family:"ＭＳ ゴシック";
  mso-fareast-font-family:"ＭＳ ゴシック"'>…</span><span lang=EN-US>/&lt;/D:href&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;D:propstat&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;D:prop&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;hm:contacts&gt;http://</span><span
  lang=EN-US style='font-family:"ＭＳ Ｐゴシック";mso-ascii-font-family:"ＭＳ ゴシック";
  mso-fareast-font-family:"ＭＳ ゴシック"'>…</span><span lang=EN-US>/abdata/&lt;/hm:contacts&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;hm:inbox&gt;http://</span><span
  lang=EN-US style='font-family:"ＭＳ Ｐゴシック";mso-ascii-font-family:"ＭＳ ゴシック";
  mso-fareast-font-family:"ＭＳ ゴシック"'>…</span><span lang=EN-US>/folders/ACTIVE/&lt;/hm:inbox&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;hm:sendmsg&gt;http://</span><span
  lang=EN-US style='font-family:"ＭＳ Ｐゴシック";mso-ascii-font-family:"ＭＳ ゴシック";
  mso-fareast-font-family:"ＭＳ ゴシック"'>…</span><span lang=EN-US>/sendmsg/&lt;/hm:sendmsg&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;hm:sentitems&gt;http://</span><span
  lang=EN-US style='font-family:"ＭＳ Ｐゴシック";mso-ascii-font-family:"ＭＳ ゴシック";
  mso-fareast-font-family:"ＭＳ ゴシック"'>…</span><span lang=EN-US>/folders/sAVeD/&lt;/hm:sentitems&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;hm:deleteditems&gt;http://</span><span
  lang=EN-US style='font-family:"ＭＳ Ｐゴシック";mso-ascii-font-family:"ＭＳ ゴシック";
  mso-fareast-font-family:"ＭＳ ゴシック"'>…</span><span lang=EN-US>/folders/trAsH/&lt;/hm:deleteditems&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;hm:msgfolderroot&gt;http://</span><span
  lang=EN-US style='font-family:"ＭＳ Ｐゴシック";mso-ascii-font-family:"ＭＳ ゴシック";
  mso-fareast-font-family:"ＭＳ ゴシック"'>…</span><span lang=EN-US>/folders/&lt;/hm:msgfolderroot&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;h:sig&gt;______________________________________________________</span></p>
  <p class=a><span lang=EN-US>Get Your Private, Free Email at
  http://www.hotmail.com</span></p>
  <p class=a><span lang=EN-US>&lt;/h:sig&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;/D:prop&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;D:status&gt;HTTP/1.1
  200 OK&lt;/D:status&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;/D:propstat&gt;</span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;/D:response&gt;</span></p>
  <p class=a><span lang=EN-US>&lt;/D:multistatus&gt;</span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>要求に対応した<span lang=EN-US>URLを応答してくる。以下の操作はここで得た各URLに対してPROPFINDを送信することで行う。また、ログイン時にはリクエストヘッダに「Depth:
0」と「Brief: t」を付加しておく必要がある。</span></p>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3 style='margin-left:42.0pt'>フォルダ情報の問い合わせ</h3>

<p class=MsoNormal>ログイン時に得た<span lang=EN-US>URLに対してPROPFINDを送信することで任意の階層のデータが取り出せる。</span></p>

<p class=MsoNormal>リクエストの例は次の通り。</p>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<div align=center>

<table border=1 cellspacing=0 cellpadding=0 width=595 style='width:445.95pt;
 border-collapse:collapse;border:none;mso-border-top-alt:solid #99CC99 1.5pt;
 mso-border-bottom-alt:solid #99CC99 1.5pt;mso-padding-alt:0mm 4.95pt 0mm 4.95pt'>
 <tr>
  <td width=595 valign=top style='width:445.95pt;border-top:solid #99CC99 1.5pt;
  border-left:none;border-bottom:solid #99CC99 .75pt;border-right:none;
  padding:0mm 4.95pt 0mm 4.95pt'>
  <p class=a><span lang=EN-US style='color:windowtext'>&lt;?xml
  version=&quot;1.0&quot;?&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>&lt;D:propfind
  xmlns:D=&quot;DAV:&quot; xmlns:hm=&quot;urn:schemas:httpmail:&quot;
  xmlns:m=&quot;urn:schemas:mailheader:&quot;&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  1'>&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;D:prop&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;D:isfolder/&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;hm:read/&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;m:hasattachment/&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;m:to/&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;m:from/&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;m:subject/&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;m:date/&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;D:getcontentlength/&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  1'>&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;/D:prop&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>&lt;/D:propfind&gt;<o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>レスポンスの例は次の通り。</p>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<div align=center>

<table border=1 cellspacing=0 cellpadding=0 width=595 style='width:445.95pt;
 border-collapse:collapse;border:none;mso-border-top-alt:solid #99CC99 1.5pt;
 mso-border-bottom-alt:solid #99CC99 1.5pt;mso-padding-alt:0mm 4.95pt 0mm 4.95pt'>
 <tr>
  <td width=595 valign=top style='width:445.95pt;border-top:solid #99CC99 1.5pt;
  border-left:none;border-bottom:solid #99CC99 .75pt;border-right:none;
  padding:0mm 4.95pt 0mm 4.95pt'>
  <p class=a><span lang=EN-US style='color:windowtext'>&lt;?xml
  version=&quot;1.0&quot; encoding=&quot;windows-1252&quot;?&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>&lt;D:multistatus
  xmlns:D=&quot;DAV:&quot; xmlns:m=&quot;urn:schemas:mailheader:&quot;
  xmlns:hm=&quot;urn:schemas:httpmail:&quot;
  xmlns:c=&quot;urn:schemas:contacts:&quot;
  xmlns:h=&quot;http://schemas.microsoft.com/hotmail/&quot;&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  1'>&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;D:response&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;D:href&gt;http://</span><span
  lang=EN-US style='font-family:"ＭＳ Ｐゴシック";mso-ascii-font-family:"ＭＳ ゴシック";
  mso-fareast-font-family:"ＭＳ ゴシック";color:windowtext'>…</span><span lang=EN-US
  style='color:windowtext'>/folders/ACTIVE/MSGxxxxxxxxx&lt;/D:href&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;D:propstat&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;D:prop&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;hm:read&gt;0&lt;/hm:read&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;m:to&gt;&lt;/m:to&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;m:from&gt;=?iso-2022-jp?B?SG90bWFpbCAbJEIlQSE8JWAwbEYxGyhC?=&lt;/m:from&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US><span style='mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;m:subject&gt;=?iso-2022-jp?B?SG90bWFpbCAbJEIkWCRoJCYkMyQ9GyhCIQ==?=&lt;/m:subject&gt;</span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;m:date&gt;1999-10-30T03:14:25&lt;/m:date&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;D:getcontentlength&gt;233&lt;/D:getcontentlength&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;/D:prop&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;D:status&gt;HTTP/1.1
  200 OK&lt;/D:status&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;/D:propstat&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  1'>&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;/D:response&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>&lt;/D:multistatus&gt;<o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>この通信で、<span lang=EN-US>inboxには１つのメールがあったため、そのメールヘッダ情報がやりとりとされている。複数メールがある場合には、D:responseが複数列挙される事になる。また、フォルダ情報取得時にはヘッダに「Brief:
t」と「Depth: 1,noroot」を付ける必要がある。</span></p>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3 style='margin-left:42.0pt'>メールの読み出し</h3>

<p class=MsoNormal>上記の手順でフォルダの情報を取得することで、各メールを取り出すための<span lang=EN-US>URL（http://…/folders/ACTIVE/MSG</span><span
lang=EN-US style='color:windowtext'>xxxxxxxxx</span>）が得られる。このアドレスに対して<span
lang=EN-US>GETコマンドを送る事でメールを受信できる。また、このURLはユニークになっているので、そのままUIDLとして使用できる。次にGETのリクエストの例を示す。GETにはコンテントはないのでヘッダを掲載する。これはPROPFIND等を行うときも同様であり、合わせてサンプルとする。</span></p>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<div align=center>

<table border=1 cellspacing=0 cellpadding=0 width=590 style='width:442.6pt;
 border-collapse:collapse;border:none;mso-border-top-alt:solid green 1.5pt;
 mso-border-bottom-alt:solid green 1.5pt;mso-padding-alt:0mm 4.95pt 0mm 4.95pt'>
 <tr>
  <td width=590 valign=top style='width:442.6pt;border-top:solid green 1.5pt;
  border-left:none;border-bottom:solid green .75pt;border-right:none;
  padding:0mm 4.95pt 0mm 4.95pt'>
  <p class=a><span lang=EN-US style='color:windowtext'>GET
  /cgi-bin/hmdata/folders/ACTIVE/MSGxxxxxxxxx HTTP/1.1<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Accept: message/rfc822,
  */*<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Translate: f<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>User-Agent: Outlook
  Express/5.0 (MSIE 5.0; Windows 98; DigExt)<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Proxy-Connection:
  Keep-Alive<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Pragma: no-cache<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Authorization: Digest
  username=&quot;mai__kawasumi@hotmail.com&quot;,
  realm=&quot;hotmail.com&quot;, qop=&quot;auth&quot;,
  algorithm=&quot;MD5&quot;,
  uri=&quot;/cgi-bin/hmdata/folders/ACTIVE/MSGxxxxxxxxx&quot;,
  nonce=&quot;OTQxMjUzMzcxOjcyNDZiMTVlOTFiOGFlZTUyNGE0ODRkZDBlNmNjNzdl&quot;,
  nc=00000004, cnonce=&quot;833a03c26c473879455249498ee51dbe&quot;,
  response=&quot;7d2cf965ea54b028ffb6a076e16c3287&quot;<o:p></o:p></span></p>
  <p class=a><![if !supportEmptyParas]>&nbsp;<![endif]><span lang=EN-US
  style='color:windowtext'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>このリクエストに対するレスポンスの例は次の通り。</p>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<div align=center>

<table border=1 cellspacing=0 cellpadding=0 width=593 style='width:444.85pt;
 border-collapse:collapse;border:none;mso-border-top-alt:solid green 1.5pt;
 mso-border-bottom-alt:solid green 1.5pt;mso-padding-alt:0mm 4.95pt 0mm 4.95pt'>
 <tr>
  <td width=593 valign=top style='width:444.85pt;border-top:solid green 1.5pt;
  border-left:none;border-bottom:solid green .75pt;border-right:none;
  padding:0mm 4.95pt 0mm 4.95pt'>
  <p class=a><span lang=EN-US style='color:windowtext'>HTTP/1.1 200 OK<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Date: Sat, 30 Oct 1999
  03:16:53 GMT<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Server: Apache/1.3.6
  (Unix) mod_ssl/2.2.8 SSLeay/0.9.0b<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Cache-Control: no-cache<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Expires: Mon, 01 Jan
  1999 00:00:00 GMT<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Pragma: no-cache<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Connection: close<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Content-Type: message/rfc822<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>From:
  =?iso-2022-jp?B?SG90bWFpbCAbJEIlQSE8JWAwbEYxGyhC?=<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Subject:
  =?iso-2022-jp?B?SG90bWFpbCAbJEIkWCRoJCYkMyQ9GyhCIQ==?=<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Date: Sat, 30 Oct 1999
  03:14:25 +0000<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Mime-Version: 1.0<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Content-Type:
  text/plain; charset=iso-2022-jp<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>$B?7$7$$%f!&lt;%6!&lt;$N3'MM$X(J<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>MSN Hotmail $B$X$h$&amp;$3$=!#(JMSN
  Hotmail $B$O!&quot;%$%s%?!&lt;%M%C%H$G:G$b5^B.$K@.D9$7$F$$$k%3%_%e%K%F%#$G$9!#(J<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>$B%F%-%9%HI=&lt;($N%V%i%&amp;%6$G$O!&quot;(JMSN
  Hotmail $B$N0lIt$N5!G=$,MxMQ$G$-$^$;$s!#(JMSN Hotmail $B$r;H$&amp;$H!&quot;$[$+$N(J
  Web $B%Z!&lt;%8$X$N%j%s%/$d2hA|$J$I!&quot;K-IY$JFbMF$r4^$`EE;R%a!&lt;%k$r$d$j$H$j$9$k$3$H$,$G$-$^$9!#(J<span
  style="mso-spacerun: yes">&nbsp; </span><o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>$B$&lt;$R!&quot;2hA|$KBP1~$7$?%V%i%&amp;%6$G(J
  MSN Hotmail $B$r$*3Z$7$_$/$@$5$$!#(J<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>MSN Hotmail $B%9%?%C%U(J<o:p></o:p></span></p>
  <p class=a><![if !supportEmptyParas]>&nbsp;<![endif]><span lang=EN-US
  style='color:windowtext'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal><span lang=EN-US style='font-size:9.5pt;mso-bidi-font-size:
10.5pt;color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3 style='margin-left:42.0pt'>メールを既読にする</h3>

<p class=MsoNormal>通常受けたばかりのメールは未読状態になっている。これを既読状態にするためにはメッセージに対応する<span
lang=EN-US>URLに対して、PROPPATCHコマンドを送信する必要がある。この時ヘッダには「Brief: t」が必要であることに注意する。成功時には200が返る。</span></p>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<div align=center>

<table border=1 cellspacing=0 cellpadding=0 width=602 style='width:451.6pt;
 border-collapse:collapse;border:none;mso-border-top-alt:solid green 1.5pt;
 mso-border-bottom-alt:solid green 1.5pt;mso-padding-alt:0mm 4.95pt 0mm 4.95pt'>
 <tr>
  <td width=602 valign=top style='width:451.6pt;border-top:solid green 1.5pt;
  border-left:none;border-bottom:solid green .75pt;border-right:none;
  padding:0mm 4.95pt 0mm 4.95pt'>
  <p class=a><span lang=EN-US style='color:windowtext'>&lt;?xml
  version=&quot;1.0&quot;?&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>&lt;D:propertyupdate
  xmlns:D=&quot;DAV:&quot; xmlns:hm=&quot;urn:schemas:httpmail:&quot;&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  1'>&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;D:set&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;D:prop&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;hm:read&gt;1&lt;/hm:read&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;/D:prop&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><span style='mso-tab-count:
  1'>&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;/D:set&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>&lt;/D:propertyupdate&gt;<o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3 style='margin-left:42.0pt'>メールをごみ箱へ移動する</h3>

<p class=MsoNormal>読み終わったメールをごみ箱へ移動するためには、メッセージに対応する<span lang=EN-US>URLに対して、MOVEコマンドを送信する必要がある。この時、フォルダ情報の問い合わせ時に返ってきたごみ箱のアドレスが必要になる。以下、MOVEコマンドで、特殊な部分を上げて解説する。</span></p>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<div align=center>

<table border=1 cellspacing=0 cellpadding=0 width=597 style='width:447.45pt;
 border-collapse:collapse;border:none;mso-border-top-alt:solid green 1.5pt;
 mso-border-bottom-alt:solid green 1.5pt;mso-padding-alt:0mm 4.95pt 0mm 4.95pt'>
 <tr>
  <td width=597 valign=top style='width:447.45pt;border-top:solid green 1.5pt;
  border-left:none;border-bottom:solid green .75pt;border-right:none;
  padding:0mm 4.95pt 0mm 4.95pt'>
  <p class=a><span lang=EN-US style='color:windowtext'>MOVE /</span><span
  lang=EN-US style='font-family:"ＭＳ Ｐゴシック";mso-ascii-font-family:"ＭＳ ゴシック";
  mso-fareast-font-family:"ＭＳ ゴシック";color:windowtext'>…</span><span lang=EN-US
  style='color:windowtext'>/folders/ACTIVE/</span><span lang=EN-US>MSG</span><span
  lang=EN-US style='color:windowtext'>xxxxxxxxx HTTP/1.1<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Destination: http://</span><span
  lang=EN-US style='font-family:"ＭＳ Ｐゴシック";mso-ascii-font-family:"ＭＳ ゴシック";
  mso-fareast-font-family:"ＭＳ ゴシック";color:windowtext'>…</span><span lang=EN-US
  style='color:windowtext'>/folders/trAsH/</span><span lang=EN-US>MSG</span><span
  lang=EN-US style='color:windowtext'>xxxxxxxxx<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Allow-Rename: t<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Content-Length: 0<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>.<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>.<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>.<o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US>Destinationには移動先でのURLを指定する必要がある。このURLはフォルダ情報の問い合わせ結果として得られたものに、メッセージの名前（MSG</span><span
lang=EN-US style='color:windowtext'>xxxxxxxxx）を加えたものである。また、「Allow-Rename」に「t」を指定しておけば、移動後の名前が衝突していても、自動的に最適な名前に変更してくれるものと思われる（未確認）。レスポンスとしては以下のようなものが返ってくる。<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<div align=center>

<table border=1 cellspacing=0 cellpadding=0 width=596 style='width:447.1pt;
 border-collapse:collapse;border:none;mso-border-top-alt:solid green 1.5pt;
 mso-border-bottom-alt:solid green 1.5pt;mso-padding-alt:0mm 4.95pt 0mm 4.95pt'>
 <tr>
  <td width=596 valign=top style='width:447.1pt;border-top:solid green 1.5pt;
  border-left:none;border-bottom:solid green .75pt;border-right:none;
  padding:0mm 4.95pt 0mm 4.95pt'>
  <p class=a><span lang=EN-US style='color:windowtext'>HTTP/1.1 201 Created<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Date: Sat, 30 Oct 1999
  03:17:16 GMT<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Server: Apache/1.3.6
  (Unix) mod_ssl/2.2.8 SSLeay/0.9.0b<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Cache-Control: no-cache<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Expires: Mon, 01 Jan
  1999 00:00:00 GMT<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Pragma: no-cache<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Location: http://</span><span
  lang=EN-US style='font-family:"ＭＳ Ｐゴシック";mso-ascii-font-family:"ＭＳ ゴシック";
  mso-fareast-font-family:"ＭＳ ゴシック";color:windowtext'>…</span><span lang=EN-US
  style='color:windowtext'>/folders/trAsH/MSGxxxxxxxxx<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Connection: close<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>Content-Type: text/html;
  charset=shift_jis<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>&lt;!-- IP: xxx.xxx.xxx.xxx
  --&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>&lt;!-- V: 08.05.10.0008
  --&gt;<o:p></o:p></span></p>
  <p class=a><span lang=EN-US style='color:windowtext'>&lt;!-- D: Thu Oct 14
  16:00:25 PDT 1999 --&gt;<o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal><span lang=EN-US><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>ステータスは<span lang=EN-US>201で、Locationに移動後のURLが入っていることに注意する。</span></p>

<span lang=EN-US style='font-size:18.0pt;font-family:"ＭＳ Ｐゴシック";mso-bidi-font-family:
"Times New Roman";color:#336666;mso-font-kerning:1.0pt;mso-ansi-language:EN-US;
mso-fareast-language:JA;mso-bidi-language:AR-SA'><br clear=all
style='page-break-before:always'>
</span>

<h2>参考</h2>

<p class=MsoNormal><span lang=EN-US>RFC1945 -- Hypertext Transfer Protocol &#8211; HTTP/1.0</span></p>

<p class=MsoNormal><span lang=EN-US>RFC2616 -- Hypertext Transfer Protocol &#8211; HTTP/1.1</span></p>

<p class=MsoNormal><span lang=EN-US>RFC1321 -- The MD5 Message-Digest Algorithm</span></p>

<p class=MsoNormal><span lang=EN-US>RFC2617 -- HTTP authentication: Basic and Digest Access Authentication</span></p>

</div>

</body>

</html>
